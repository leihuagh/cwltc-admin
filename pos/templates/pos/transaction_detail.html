{% extends 'base.html' %}
{% block content %}
<div class="container">
  <div class="row">
    <div class="col-md-6">
      <h2>POS Transaction detail</h2>
      <h4>Created by {{ transaction.person.fullname }}</h4>
      <h4>{{ transaction.creation_date }}</h4>
      <h4>Id: {{  transaction.id }}</h4>
      <table class="table">
        {% for lineitem in items %}
          <tr><td>{{ lineitem.quantity }}</td><td>{{ lineitem.item.description }}</td><td>£ {{ lineitem.sale_price }}</td>
          <td>{{ lineitem.item_type.description }}</td></tr>
        {% endfor %}
        <tr><td></td><td><strong>Total:</strong></td><td><strong>£ {{ transaction.total }}</strong></td></tr>
      </table>
    {% if payments %}
    <h4>Split payments</h4>
      <table class="table">
        {% for payment in payments %}
          <tr><td>{{ payment.person.fullname }}</td><td>£ {{ payment.amount }}</td></tr>
        {% endfor %}
      </table>
    {% endif %}
    </div>
  </div>
  <h4>This transaction has {% if not payment.0.billed %}not yet{% endif %} been invoiced.</h4>
<button id="back1" class="btn btn-primary" onclick="parent.history.back()">Back</button>
{% if admin and not payment.0.billed %}
  <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#idModal">Delete</button>
{% endif %}
<form id='form' method="post">{% csrf_token %}
</form>
</div>

  <!-- Modal for member mode -->
<div id="idModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h3 class="modal-title">Delete transaction</h3>
      </div>
      <div class="modal-body">
        <h4>This action cannot be reversed.</h4>
      </div>
      <div class="modal-footer">
        <button class="btn btn-default" data-dismiss="modal">
          Cancel
        </button>
        <button class="btn btn-danger" data-dismiss="modal" onclick="document.getElementById('form').submit()">
          Delete
        </button>

      </div>
    </div>
  </div>
</div>
{% endblock %}
