{% extends 'pos/base.html' %}
{% load static %}
{% block content %}

  {%  include '_logo_banner.html' %}

  <div class="container">
  <div class="jumbotron text-center bg">
    <h1 class="text-center"><strong>
      {% if is_bar %}Honesty Bar{% else %}Online Member Services{% endif %}</strong></h1>
    <br>
    <div id="idOnlineMessage"> <!-- division is hidden if ping fails -->
      <div class="row">
        <p class="ipad-error">{{ request.session.message }}</p>
        <form method="post">{% csrf_token %}
          {% for app in apps %}
            {% if is_bar %}
              <button class="posbutton btn-large btn-block" type="submit" name="App_{{ app.id }}">{{ app.name }}</button>
              {% if attended %}
                <br/><br/><br/>
                <input class="posbutton btn-large" type="submit" name="attended" value="Attended mode">
                <br>
              {% endif %}
            {% else %}
              <div class="row">
                <div class="col-md-2 col-md-offset-4 text-center">
                  <button class="posbutton btn-large btn-block" type="submit" name="App_{{ app.id }}">{{ app.name }}</button>
                </div>
                <div class="col-md-5 col-md-offset-1">
                  <p class="hint">{{ app.description }}</p>
                </div>
              </div>
            {% endif %}
                <br>
          {% endfor %}
        </form>
      </div>

      <p class="hint">All members who have paid their subscription can use this system after registration.<br>
          You can register now by pressing the button and searching for your name.</p>
    </div>
    <p id="idOfflineMessage"></p><!-- division is visible if ping fails -->
  </div>
</div>
<div class="terminal">Terminal: {{ request.session.terminal }}
  <span id="idOnline"></span></div>
<div class="last-transaction">
  Last transaction: {{ request.session.last_person }}: £ {{ request.session.last_total }}
</div>
{% endblock %}
{% block scripts %}
<script>
  $(document).ready(function () {
    $(".posbutton").on('touchstart', function(event) {
      event.currentTarget.classList.add('posbutton-down');
    });
    $(".posbutton").on('touchend', function(event) {
      event.currentTarget.classList.remove('posbutton-down');
    });
    timingCode.initPing({{ timeout }}, '{{ ping_url }}', '{{ csrf_token }}', '{{ request.session.terminal }}', 'idMessage');
    });
</script>
{% endblock %}